<!--COLLEGE OF CAPTIVATION-->

new entry "Projectile_CaptivatingReclaim"
type "SpellData"
data "SpellType" "Projectile"
data "DisplayName" "habfab1deg96a3g4928gbb99g29b61ef00004;1"
data "Description" "hacc1d957g1ef1g4debg9f26gc25bcf40000d;2"
data "DescriptionParams" "Distance(9)"
data "Icon" "Action_MantleOfInspiration"
data "SpellProperties" "RestoreResource(BardicInspiration,1,0);ApplyStatus(BARDICRESTORE_VFX,100,0)"
data "SpellFlags" "ImmediateCast"
data "AreaRadius" "9"
data "ExplodeRadius" "9"
data "CastEffect" "d2a8a9aa-6451-411c-90fb-a01236388280"
data "Trajectories" "4505c63a-cb98-42bb-942b-3a739feecef8,d429d77c-33a8-a362-c38d-3dc446057386,c88fac5e-79c8-3abe-20d5-2dc7c02c9661"
data "TargetConditions" "HasPassive('CaptivatingReclaim')"
data "HitAnimationType" "None"

<!--COLLEGE OF STEEL-->

new entry "Projectile_BladeFlourish_Defensive"
type "SpellData"
data "SpellType" "Projectile"
using "Projectile_MainHandAttack"
data "SpellProperties" "GROUND:DealDamage(MainRangedWeapon, MainRangedWeaponDamageType);GROUND:ExecuteWeaponFunctors(MainHand); ApplyStatus(SELF,BLADE_FLOURISH_DEFENSIVE,100,1);AI_ONLY:ApplyStatus(SELF,AI_HELPER_BUFF,100,0)"
data "SpellRoll" "Attack(AttackType.RangedWeaponAttack)"
data "SpellSuccess" "DealDamage(max(1,MainRangedWeapon + LevelMapValue(BardicInspiration)), MainRangedWeaponDamageType); ExecuteWeaponFunctors(MainHand)"
data "Trajectories" "4d75cb6e-0fa2-4305-a18c-15876e55e031"
data "Icon" "Action_DefensiveFlourish_Ranged"
data "DisplayName" "h9425b988gfa9fg4032g9858g68069eb341a2;3"
data "Description" "h13e4b442gcfacg4213g8a47gc852e5d82796;7"
data "DescriptionParams" "4"
data "TooltipDamageList" "DealDamage(MainRangedWeapon + LevelMapValue(BardicInspiration), MainRangedWeaponDamageType)"
data "TooltipStatusApply" "ApplyStatus(BLADE_FLOURISH_DEFENSIVE,100,1)"
data "PrepareSound" "Action_Prepare_Bard_Flourish"
data "PrepareLoopSound" "Action_Loop_Bard_Flourish"
data "CastSound" "Action_Cast_Bard_DefensiveFlourishRanged"
data "UseCosts" "ActionPoint:1;BardicInspiration:1"
data "SpellAnimation" "a09de2c8-ec46-4c27-a502-bc92cf293fe5,,;9583ecee-cf6c-4735-86db-7ebf1df15eae,,;de006e3f-70fb-4eb7-a98d-d845d15b20e8,,;50696db7-d931-4734-915d-32d038ba99a5,,;244b53cb-dc0f-4932-afd0-ab19c6df1b34,,;,,;f920a0a6-f257-4ce4-8d17-2dcaa7bb7bbb,,;,,;,,"
data "VerbalIntent" "Damage"
data "SpellFlags" "HasHighGroundRangeExtension;RangeIgnoreVerticalThreshold;IsHarmful"
data "PrepareEffect" "00d37401-b1a7-42eb-ad64-ca4954111a85"
data "CastEffect" "27ae62db-1606-4e42-9bc9-aeb09dcc4f64"

new entry "Projectile_BladeFlourish_Mobile"
type "SpellData"
data "SpellType" "Projectile"
using "Projectile_BladeFlourish_Defensive"
data "SpellProperties" "GROUND:DealDamage(MainRangedWeapon, MainRangedWeaponDamageType);GROUND:ExecuteWeaponFunctors(MainHand);AI_ONLY:ApplyStatus(SELF,AI_HELPER_BUFF,100,0)"
data "SpellSuccess" "DealDamage(max(1,MainRangedWeapon + LevelMapValue(BardicInspiration)), MainRangedWeaponDamageType); ExecuteWeaponFunctors(MainHand); Force(9); ApplyStatus(SELF,BLADE_FLOURISH_MOBILE,100,1);AI_ONLY:ApplyStatus(SELF,AI_HELPER_BUFF,100,0)"
data "Icon" "Action_MobileFlourish_Ranged"
data "DisplayName" "h91b9b587gbf8ag4c6eg9702g3c00e2aaa512;3"
data "Description" "h10a8c9aeg528cg4e75g8eabg75a40280d77d;2"
data "DescriptionParams" "Distance(9)"
data "TooltipStatusApply" ""
data "PrepareSound" "Action_Prepare_Bard_Flourish"
data "PrepareLoopSound" "Action_Loop_Bard_Flourish"
data "CastSound" "Action_Cast_Bard_MobileFlourishRanged"
data "SpellFlags" "HasHighGroundRangeExtension;RangeIgnoreVerticalThreshold;IsHarmful;AddFallDamageOnLand"
data "UseCosts" "ActionPoint:1;BardicInspiration:1"

new entry "Projectile_BladeFlourish_Slashing"
type "SpellData"
data "SpellType" "Projectile"
using "Projectile_BladeFlourish_Defensive"
data "SpellProperties" "GROUND:DealDamage(MainRangedWeapon, MainRangedWeaponDamageType);GROUND:ExecuteWeaponFunctors(MainHand);AI_ONLY:ApplyStatus(SELF,AI_HELPER_BUFF,100,0)"
data "SpellSuccess" "DealDamage(max(1,MainRangedWeapon + LevelMapValue(BardicInspiration)), MainRangedWeaponDamageType); ExecuteWeaponFunctors(MainHand)"
data "Icon" "Action_SlashingFlourish_Ranged"
data "DisplayName" "heb634e12g0cefg4e3eg98d1ge9640cf537ae;3"
data "Description" "h41a799d2gcfaag4f5cga5caga114345edb03;4"
data "TooltipStatusApply" ""
data "PrepareSound" "Action_Prepare_Bard_Flourish"
data "PrepareLoopSound" "Action_Loop_Bard_Flourish"
data "CastSound" "Action_Cast_Bard_SlashingFlourishRanged"
data "PrepareEffect" "00d37401-b1a7-42eb-ad64-ca4954111a85"
data "CastEffect" "27ae62db-1606-4e42-9bc9-aeb09dcc4f64"
data "UseCosts" "ActionPoint:1;BardicInspiration:1"
data "SpellFlags" "HasHighGroundRangeExtension;RangeIgnoreVerticalThreshold;IsHarmful;IgnorePreviouslyPickedEntities"
data "AmountOfTargets" "2"

<!--COLLEGE OF VALOR-->

new entry "Projectile_ValorousCamaraderie"
type "SpellData"
data "SpellType" "Projectile"
data "SpellRoll" "not SavingThrow(Ability.Constitution, SourceSpellDC())"
data "SpellSuccess" "DealDamage(LevelMapValue(BardicInspiration), Thunder,Magical)"
data "SpellFail" "DealDamage(LevelMapValue(BardicInspiration)/2, Thunder,Magical)"
data "TargetFloor" "-1"
data "TargetRadius" "9"
data "TargetConditions" "not Self() and Enemy() and not Dead()"
data "ProjectileCount" "99"
data "Trajectories" "c7cd4b0a-2b2e-47ae-a4e8-849ad5d448f8"
data "Icon" "PassiveFeature_BardicInspiration_Damage"
data "DisplayName" "h22af06bagd2d2g4b30ga1adg8e6a48155122;2"
data "Description" "hd8bd4b9fg59a5g4295g9ab0g199a999778dd;1"
data "DescriptionParams" "Distance(9);DealDamage(LevelMapValue(BardicInspiration), Thunder)"
data "TooltipDamageList" "DealDamage(LevelMapValue(BardicInspiration), Thunder)"
data "PrepareSound" "Spell_Prepare_Buff_ElementalWeaponThunder_L1to3"
data "PrepareLoopSound" "Spell_Loop_Buff_ElementalWeaponThunder_L1to3"
data "CastSound" "Spell_Cast_Damage_Thunder_ChromaticOrbThunder_L1to3"
data "VocalComponentSound" "Empty"
data "CastTextEvent" "Cast"
data "CycleConditions" "Enemy() and not Dead()"
data "SpellAnimation" "3ff87abf-1ea1-4c32-aadf-c822d74c7dc0,,;,,;cd5e5d4a-38e1-4d4d-b346-3fbc1e4c3c90,,;141f48d9-9615-496a-8737-9240f0dba60d,,;d8925ce4-d6d9-400c-92f5-ad772ef7f178,,;,,;eadedcce-d01b-4fbb-a1ae-d218f13aa5d6,,;,,;,,"
data "VerbalIntent" "Damage"
data "SpellFlags" "HasHighGroundRangeExtension"
data "MemoryCost" "1"
data "CastSound" "Spell_Cast_Damage_Thunder_ChromaticOrbThunder_L1to3"
data "PrepareEffect" "db5705a1-824d-42a3-8d09-2352b9cd4af9"
data "DamageType" "Thunder"

<!--PASSIVES-->

new entry "Projectile_BardicInspiration"
type "SpellData"
data "SpellType" "Projectile"
data "SpellProperties" "IF(not ClassLevelHigherOrEqualThan(5,'Bard') and not HasPassive('CombatInspiration', context.Source)):ApplyStatus(BARDIC_INSPIRATION,100, -1);IF(ClassLevelHigherOrEqualThan(5,'Bard') and not ClassLevelHigherOrEqualThan(9,'Bard') and not HasPassive('CombatInspiration', context.Source)):ApplyStatus(BARDIC_INSPIRATION_D8,100, -1);IF(ClassLevelHigherOrEqualThan(9,'Bard') and not HasPassive('CombatInspiration', context.Source)):ApplyStatus(BARDIC_INSPIRATION_D10,100, -1);IF(not ClassLevelHigherOrEqualThan(5,'Bard') and HasPassive('CombatInspiration', context.Source)):ApplyStatus(BARDIC_INSPIRATION_COMBAT,100, -1);IF(ClassLevelHigherOrEqualThan(5,'Bard') and not ClassLevelHigherOrEqualThan(9,'Bard') and HasPassive('CombatInspiration', context.Source)):ApplyStatus(BARDIC_INSPIRATION_COMBAT_D8,100, -1);IF(ClassLevelHigherOrEqualThan(9,'Bard') and HasPassive('CombatInspiration', context.Source)):ApplyStatus(BARDIC_INSPIRATION_COMBAT_D10,100, -1);IF(HasPassive('Echoes_of_Fortitude',context.Source)):ApplyStatus(ECHOES_OF_FORTITUDE,100, -1);IF(HasPassive('Encouraging_Momentum',context.Source) or HasPassive('Encouraging_Momentum_Item',context.Source)):ApplyStatus(DASH,100,1);IF(HasPassive('Encouraging_Momentum',context.Source) or HasPassive('Encouraging_Momentum_Item',context.Source)):ApplyStatus(DISENGAGE,100,1);IF(HasPassive('Encouraging_Momentum',context.Source) or HasPassive('Encouraging_Momentum_Item',context.Source)):ApplyStatus(SELF,DASH,100,1);IF(HasPassive('Encouraging_Momentum',context.Source) or HasPassive('Encouraging_Momentum_Item',context.Source)):ApplyStatus(SELF,DISENGAGE,100,1);IF(HasPassive('Engaging_Composition',context.Source) and HasWeaponInMainHand(context.Target)):ApplyStatus(COMMANDERS_STRIKE_D8_BARD,100,-1);IF(HasPassive('Inspirational_Resonance',context.Source)):CreateExplosion(Projectile_Inspirational_Resonance);IF(HasPassive('Soothing_Words',context.Source) or HasPassive('Soothing_Words_Item',context.Source)):ApplyStatus(SOOTHING_WORDS,100,-1);IF(HasPassive('Unprecedented_Encore',context.Source)):TriggerRandomCast(17,,WildMagicPositive);IF(HasPassive('Mobile_Maestro',context.Source)):SwapPlaces();AI_ONLY:ApplyStatus(SELF,AI_HELPER_BUFF,100,0)"
data "AreaRadius" "9"
data "ExplodeRadius" "9"
data "TargetConditions" "Character() and not Enemy() and not Self() and not (HasStatus('BARDIC_INSPIRATION') or HasStatus('BARDIC_INSPIRATION_D8') or HasStatus('BARDIC_INSPIRATION_COMBAT') or HasStatus('BARDIC_INSPIRATION_COMBAT_D8'))"
data "Icon" "Action_Bard_RestoreBardicInspiration"
data "DisplayName" "he811cf79gab9dg4fc3g908dg12f52b41e976;1"
data "Description" "hb2e60320g20ebg4a60gb572g098b49a5c544;5"
data "DescriptionParams" "LevelMapValue(BardicInspiration)"
data "TooltipStatusApply" "ApplyStatus(BARDIC_INSPIRATION,100, -1)"
data "CastSound" "Spell_Cast_Bard_BardicInspiration_L1to3"
data "TargetSound" "Spell_Impact_Bard_BardicInspiration_L1to3"
data "PreviewCursor" "Cast"
data "CastTextEvent" "Cast"
data "InstrumentComponentPrepareSound" "Instrument_Bard_BardicInspiration_Prepare"
data "InstrumentComponentLoopingSound" "Instrument_Bard_BardicInspiration_Loop"
data "InstrumentComponentCastSound" "Instrument_Bard_BardicInspiration_Cast"
data "InstrumentComponentImpactSound" "Instrument_Bard_BardicInspiration_Impact"
data "CycleConditions" "Ally() and not Dead()"
data "UseCosts" "BonusActionPoint:1;BardicInspiration:1"
data "SpellAnimation" "850cd2f3-dde2-475d-b3a3-f35c47333523,,;,,;62819708-175d-4ad4-95d5-55757e18d981,,;2a6a403d-1b6f-41ea-9324-445761b2cbb3,,;ad775f69-0d9f-4215-bfc2-8e0ec7e32189,,;,,;6bfce8a0-80f1-47a8-97f4-34f4b8b6fe9e,,;,,;,,"
data "VerbalIntent" "Buff"
data "SpellStyleGroup" "Class"
data "SpellFlags" "HasVerbalComponent"
data "HitAnimationType" "None"
data "MaximumTargets" "1"
data "PrepareEffect" "cc478d8f-d3eb-46dc-844c-203ae2ec7df5"
data "CastEffect" "6c5aecc7-c5a0-4fda-9f9b-24afe3e1f76a"
data "TargetEffect" "b4d2ce64-af72-45a2-8146-6a9c3b71f1a6"
data "Trajectories" "213039ac-b17a-4e87-91f3-11b297525b76"
data "SpellSoundMagnitude" "Big"
data "Sheathing" "DontChange"
data "CombatAIOverrideSpell" "Projectile_BardicInspiration_NPC"

new entry "Projectile_BardicInspiration_NPC"
type "SpellData"
data "SpellType" "Projectile"
using "Projectile_BardicInspiration"
data "SpellProperties" "IF(not CharacterLevelGreaterThan(4) and not HasPassive('CombatInspiration', context.Source)):ApplyStatus(BARDIC_INSPIRATION,100, -1);IF(CharacterLevelGreaterThan(4) and not CharacterLevelGreaterThan(8) and not HasPassive('CombatInspiration', context.Source)):ApplyStatus(BARDIC_INSPIRATION_D8,100, -1);IF(CharacterLevelGreaterThan(8) and not HasPassive('CombatInspiration', context.Source)):ApplyStatus(BARDIC_INSPIRATION_D10,100, -1);IF(not CharacterLevelGreaterThan(4) and HasPassive('CombatInspiration', context.Source)):ApplyStatus(BARDIC_INSPIRATION_COMBAT,100, -1);IF(CharacterLevelGreaterThan(4) and not CharacterLevelGreaterThan(8) and HasPassive('CombatInspiration', context.Source)):ApplyStatus(BARDIC_INSPIRATION_COMBAT_D8,100, -1);IF(CharacterLevelGreaterThan(8) and HasPassive('CombatInspiration', context.Source)):ApplyStatus(BARDIC_INSPIRATION_COMBAT_D10,100, -1);IF(HasPassive('Echoes_of_Fortitude',context.Source)):ApplyStatus(ECHOES_OF_FORTITUDE,100, -1);IF(HasPassive('Encouraging_Momentum',context.Source) or HasPassive('Encouraging_Momentum_Item',context.Source)):ApplyStatus(DASH,100,1);IF(HasPassive('Encouraging_Momentum',context.Source) or HasPassive('Encouraging_Momentum_Item',context.Source)):ApplyStatus(DISENGAGE,100,1);IF(HasPassive('Encouraging_Momentum',context.Source) or HasPassive('Encouraging_Momentum_Item',context.Source)):ApplyStatus(SELF,DASH,100,1);IF(HasPassive('Encouraging_Momentum',context.Source) or HasPassive('Encouraging_Momentum_Item',context.Source)):ApplyStatus(SELF,DISENGAGE,100,1);IF(HasPassive('Engaging_Composition',context.Source) and HasWeaponInMainHand(context.Target)):ApplyStatus(COMMANDERS_STRIKE_D8_BARD,100,-1);IF(HasPassive('Inspirational_Resonance',context.Source)):CreateExplosion(Projectile_Inspirational_Resonance);IF(HasPassive('Soothing_Words',context.Source) or HasPassive('Soothing_Words_Item',context.Source)):ApplyStatus(SOOTHING_WORDS,100,-1);IF(HasPassive('Unprecedented_Encore',context.Source)):TriggerRandomCast(17,,WildMagicPositive);IF(HasPassive('Mobile_Maestro',context.Source)):SwapPlaces();AI_ONLY:ApplyStatus(SELF,AI_HELPER_BUFF,100,0)"
data "CombatAIOverrideSpell" ""

new entry "Projectile_Inspirational_Resonance"
type "SpellData"
data "SpellType" "Projectile"
data "DisplayName" "171ffb649bb448399193ed1c0d6896dd00z11;1"
data "Description" "171ffb649bb448399193ed1c0d6896dd000zk;2"
data "Icon" "PassiveFeature_MagicInitiateBard"
data "SpellRoll" "not SavingThrow(Ability.Strength, SourceSpellDC())"
data "SpellSuccess" "Force(9, TargetToEntity)"
data "SpellFlags" "AddFallDamageOnLand;IsHarmful;CanAreaDamageEvade;ImmediateCast"
data "AreaRadius" "9"
data "ExplodeRadius" "9"
data "CastEffect" "d2a8a9aa-6451-411c-90fb-a01236388280"
data "Trajectories" "4505c63a-cb98-42bb-942b-3a739feecef8,d429d77c-33a8-a362-c38d-3dc446057386,c88fac5e-79c8-3abe-20d5-2dc7c02c9661"
data "TargetConditions" "Enemy()"

new entry "Projectile_CommanderStrike_Attack_D8_Bard"
type "SpellData"
data "SpellType" "Projectile"
using "Projectile_MainHandAttack"
data "SpellProperties" "GROUND:DealDamage(MainRangedWeapon + LevelMapValue(BardicInspiration, MainRangedWeaponDamageType);GROUND:ExecuteWeaponFunctors(MainHand)"
data "SpellSuccess" "DealDamage(MainRangedWeapon + LevelMapValue(BardicInspiration), MainRangedWeaponDamageType);ExecuteWeaponFunctors(MainHand)"
data "Icon" "Action_Bladesong_Ranged"
data "DisplayName" "h4344309ag115dg487bgbdcbg14552d822356;2"
data "TooltipDamageList" "DealDamage(MainRangedWeapon + LevelMapValue(BardicInspiration), MainRangedWeaponDamageType)"
data "UseCosts" "ReactionActionPoint:1"
data "SpellAnimation" "a09de2c8-ec46-4c27-a502-bc92cf293fe5,,;9583ecee-cf6c-4735-86db-7ebf1df15eae,,;de006e3f-70fb-4eb7-a98d-d845d15b20e8,,;50696db7-d931-4734-915d-32d038ba99a5,,;244b53cb-dc0f-4932-afd0-ab19c6df1b34,,;,,;f920a0a6-f257-4ce4-8d17-2dcaa7bb7bbb,,;,,;,,"
data "SpellFlags" "IsAttack;IsHarmful;HasHighGroundRangeExtension;RangeIgnoreVerticalThreshold;Temporary"

new entry "Projectile_CommanderStrike_Attack_D8_Bard_Caster"
type "SpellData"
data "SpellType" "Projectile"
using "Projectile_MainHandAttack"
data "SpellProperties" "GROUND:DealDamage(MainRangedWeapon + LevelMapValue(BardicInspiration, MainRangedWeaponDamageType);GROUND:ExecuteWeaponFunctors(MainHand)"
data "SpellSuccess" "DealDamage(MainRangedWeapon + LevelMapValue(BardicInspiration), MainRangedWeaponDamageType);ExecuteWeaponFunctors(MainHand)"
data "Icon" "Action_Bladesong_Ranged"
data "DisplayName" "h4344309ag115dg487bgbdcbg14552d822356;2"
data "TooltipDamageList" "DealDamage(MainRangedWeapon + LevelMapValue(BardicInspiration), MainRangedWeaponDamageType)"
data "UseCosts" "ReactionActionPoint:1;BardicInspiration:1"
data "SpellAnimation" "a09de2c8-ec46-4c27-a502-bc92cf293fe5,,;9583ecee-cf6c-4735-86db-7ebf1df15eae,,;de006e3f-70fb-4eb7-a98d-d845d15b20e8,,;50696db7-d931-4734-915d-32d038ba99a5,,;244b53cb-dc0f-4932-afd0-ab19c6df1b34,,;,,;f920a0a6-f257-4ce4-8d17-2dcaa7bb7bbb,,;,,;,,"
