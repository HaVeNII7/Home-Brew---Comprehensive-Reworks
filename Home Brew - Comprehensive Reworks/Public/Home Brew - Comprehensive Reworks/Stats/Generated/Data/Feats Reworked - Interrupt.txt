<!--COMPOSED-->

new entry "Interrupt_ComposedSelf"
type "InterruptData"
data "DisplayName" "8a87461fd8dd4f5b9098ded714f6c8aa00z18;2"
data "Description" "8a87461fd8dd4f5b9098ded714f6c8aa000zr;4"
data "DescriptionParams" "Distance(3)"
data "Icon" "PassiveFeature_RitualCasting"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Self"
data "InterruptFlags" "InterruptWhileInvisible"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and Enemy(context.Source,context.Observer) and not IsMiss() and not HasStatus('SG_Invisible',context.Source) and not AnyEntityIsItem() and TotalAttackDamageDoneGreaterThan(0) and HasLastAttackTriggered()"
data "Properties" "CreateExplosion(OBSERVER_OBSERVER,Projectile_Composed)"
data "Cost" "ReactionActionPoint:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "Stack" "OnDamaged"

new entry "Interrupt_ComposedTarget"
type "InterruptData"
data "DisplayName" "8a87461fd8dd4f5b9098ded714f6c8aa0zz18;1"
data "Description" "8a87461fd8dd4f5b9098ded714f6c8aa00zzr;1"
data "DescriptionParams" "Distance(3)"
data "Icon" "Spell_Evocation_PowerWordHeal"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Self"
data "InterruptFlags" "InterruptWhileInvisible"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and Enemy(context.Target,context.Observer) and IsAttack() and HasDamageEffectFlag(DamageFlags.Hit) and not IsMiss() and not AnyEntityIsItem() and TotalAttackDamageDoneGreaterThan(0)"
data "Properties" "CreateExplosion(Projectile_Composed)"
data "Cost" "ReactionActionPoint:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "Stack" "OnDamage"

<!--DEFENSIVE DUELIST-->

new entry "Interrupt_DefensiveDuelist"
type "InterruptData"
data "DisplayName" "8a87461fd8dd4f5b9098ded714f6c8aa00z19;1"
data "Description" "8a87461fd8dd4f5b9098ded714f6c8aa000zs;4"
data "Icon" "PassiveFeature_DefensiveDualist"
data "InterruptContext" "OnPostRoll"
data "InterruptContextScope" "Self"
data "InterruptFlags" "InterruptWhileInvisible"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and HasInterruptedAttack() and Self(context.Target,context.Observer) and not AnyEntityIsItem() and IsFlatValueInterruptInteresting(context.Observer.ProficiencyBonus, context.Source)"
data "Properties" "AdjustRoll(OBSERVER_OBSERVER,0-ProficiencyBonus);ApplyStatus(SWAP,PASSIVE_DEFENSIVE_DUELIST,100,0);ApplyStatus(OBSERVER_OBSERVER,INTERRUPT_DEFENSIVE_DUELIST,100,0)"
data "InterruptDefaultValue" "Enabled"
data "EnableCondition" "not HasStatus('SG_Blinded')"
data "EnableContext" "OnStatusRemoved;OnStatusApplied"
data "SpellStyleGroup" "Class"
data "Stack" "SelfAboutBeHit"

new entry "Interrupt_DefensiveRiposte"
type "InterruptData"
data "DisplayName" "8a87461fd8dd4f5b9098ded714f6c8aa0zz19;1"
data "Description" "8a87461fd8dd4f5b9098ded714f6c8aa00zzs;3"
data "Icon" "Action_Riposte"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Self"
data "InterruptFlags" "InterruptWhileInvisible"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and Enemy(context.Source,context.Observer) and CanSee(context.Source,context.Observer) and IsMiss() and not HasStatus('SG_Invisible',context.Source) and not HasStatus('FIREARM_MALFUNCTION',context.Observer) and not AnyEntityIsItem() and HasLastAttackTriggered() and ((not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer)) or (not DistanceToEntityGreaterThan(18, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and not HasPassive('Concealed_Carry_Description', context.Source) and not HasPassive('Offhand_Dual_Wield_Ranged', context.Source) and not IsWeaponOfProficiencyGroup('Slings', GetItemInEquipmentSlot(EquipmentSlot.RangedOffHand))) or (not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('Concealed_Carry_Description', context.Source) and not HasPassive('Offhand_Dual_Wield_Ranged', context.Source) and not IsWeaponOfProficiencyGroup('Slings', GetItemInEquipmentSlot(EquipmentSlot.RangedOffHand))) or (not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('Concealed_Carry_Description', context.Source) and HasPassive('Offhand_Dual_Wield_Ranged', context.Source) and not IsWeaponOfProficiencyGroup('Slings', GetItemInEquipmentSlot(EquipmentSlot.RangedOffHand))) or (not DistanceToEntityGreaterThan(18, context.ObserverPosition, context.Source) and IsWeaponOfProficiencyGroup('Slings', GetItemInEquipmentSlot(EquipmentSlot.RangedOffHand)) and HasPassive('HighRange_Firearm_Passive', context.Source)) or (not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and IsWeaponOfProficiencyGroup('Slings', GetItemInEquipmentSlot(EquipmentSlot.RangedOffHand)) and HasPassive('MidRange_Firearm_Passive', context.Source)) or (not DistanceToEntityGreaterThan(4.5, context.ObserverPosition, context.Source) and IsWeaponOfProficiencyGroup('Slings', GetItemInEquipmentSlot(EquipmentSlot.RangedOffHand)) and HasPassive('LowRange_Firearm_Passive', context.Source)))"
data "Properties" "IF(not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer) and not Unarmed(context.Observer) and (not HasPassive('DualWielder', context.Observer) or HasPassive('DualWielder', context.Observer) and not HasPassive('Offhand_Dual_Wield', context.Observer))):UseSpell(SWAP,Target_MainHandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer) and not Unarmed(context.Observer) and (HasPassive('DualWielder', context.Observer) or HasPassive('Natural_Opportunity', context.Observer)) and HasPassive('Offhand_Dual_Wield', context.Observer)):UseSpell(SWAP,Target_OffhandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer) and (Unarmed(context.Observer) or HasStatus('SG_Polymorph_BeastShape', context.Observer))):UseAttack(OBSERVER_SOURCE);IF(not DistanceToEntityGreaterThan(18, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and (not HasPassive('DualWielder', context.Observer) or HasPassive('DualWielder', context.Observer) and not (HasPassive('Concealed_Carry_Description', context.Observer) or HasPassive('LowRange_Firearm_Passive', context.Observer) or HasPassive('MidRange_Firearm_Passive', context.Observer) or HasPassive('HighRange_Firearm_Passive', context.Observer)))):UseSpell(SWAP,Projectile_MainHandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and (not HasPassive('DualWielder', context.Observer) or HasPassive('DualWielder', context.Observer) and HasPassive('Concealed_Carry_Description', context.Observer) and not HasPassive('Offhand_Dual_Wield_Ranged', context.Observer))):UseSpell(SWAP,Projectile_MainHandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and (HasPassive('DualWielder', context.Observer) or HasPassive('Natural_Opportunity', context.Observer)) and HasPassive('Offhand_Dual_Wield_Ranged', context.Observer)):UseSpell(SWAP,Projectile_OffhandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('LowRange_Firearm_Passive', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack_Blunderbuss,true,true,true);IF(not DistanceToEntityGreaterThan(18, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and (HasPassive('MidRange_Firearm_Passive', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack_Flintlock,true,true,true);IF(not DistanceToEntityGreaterThan(36, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('HighRange_Firearm_Passive', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack_Musket,true,true,true)"
data "Cost" "ReactionActionPoint:1;CounterAction:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Blinded')"
data "EnableContext" "OnStatusRemoved;OnStatusApplied"
data "Stack" "OnDodge"

<!--MAGE SLAYER-->

new entry "Interrupt_MageSlayer"
type "InterruptData"
data "DisplayName" "8a87461fd8dd4f5b9098ded714f6c8aa00z27;1"
data "Description" "8a87461fd8dd4f5b9098ded714f6c8aa00za0;2"
data "Icon" "PassiveFeature_MageSlayer_AttackACaster"
data "InterruptContext" "OnSpellCast"
data "InterruptContextScope" "Nearby"
data "InterruptFlags" "InterruptWhileInvisible"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and Enemy(context.Source,context.Observer) and IsSpell() and CanSee(context.Source,context.Observer) and not HasStatus('SG_Invisible',context.Source) and not HasStatus('FIREARM_MALFUNCTION',context.Observer) and not AnyEntityIsItem() and ((not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer)) or (not DistanceToEntityGreaterThan(18, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and not HasPassive('Concealed_Carry_Description', context.Source) and not HasPassive('Offhand_Dual_Wield_Ranged', context.Source) and not IsWeaponOfProficiencyGroup('Slings', GetItemInEquipmentSlot(EquipmentSlot.RangedOffHand))) or (not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('Concealed_Carry_Description', context.Source) and not HasPassive('Offhand_Dual_Wield_Ranged', context.Source) and not IsWeaponOfProficiencyGroup('Slings', GetItemInEquipmentSlot(EquipmentSlot.RangedOffHand))) or (not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('Concealed_Carry_Description', context.Source) and HasPassive('Offhand_Dual_Wield_Ranged', context.Source) and not IsWeaponOfProficiencyGroup('Slings', GetItemInEquipmentSlot(EquipmentSlot.RangedOffHand))) or (not DistanceToEntityGreaterThan(18, context.ObserverPosition, context.Source) and IsWeaponOfProficiencyGroup('Slings', GetItemInEquipmentSlot(EquipmentSlot.RangedOffHand)) and HasPassive('HighRange_Firearm_Passive', context.Source)) or (not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and IsWeaponOfProficiencyGroup('Slings', GetItemInEquipmentSlot(EquipmentSlot.RangedOffHand)) and HasPassive('MidRange_Firearm_Passive', context.Source)) or (not DistanceToEntityGreaterThan(4.5, context.ObserverPosition, context.Source) and IsWeaponOfProficiencyGroup('Slings', GetItemInEquipmentSlot(EquipmentSlot.RangedOffHand)) and HasPassive('LowRange_Firearm_Passive', context.Source)))"
data "Properties" "IF(not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer) and not Unarmed(context.Observer) and (not HasPassive('DualWielder', context.Observer) or HasPassive('DualWielder', context.Observer) and not HasPassive('Offhand_Dual_Wield', context.Observer))):UseSpell(OBSERVER_SOURCE,Target_MainHandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer) and not Unarmed(context.Observer) and (HasPassive('DualWielder', context.Observer) or HasPassive('Natural_Opportunity', context.Observer)) and HasPassive('Offhand_Dual_Wield', context.Observer)):UseSpell(OBSERVER_SOURCE,Target_OffhandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer) and (Unarmed(context.Observer) or HasStatus('SG_Polymorph_BeastShape', context.Observer))):UseAttack(OBSERVER_SOURCE);IF(not DistanceToEntityGreaterThan(18, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and (not HasPassive('DualWielder', context.Observer) or HasPassive('DualWielder', context.Observer) and not (HasPassive('Concealed_Carry_Description', context.Observer) or HasPassive('LowRange_Firearm_Passive', context.Observer) or HasPassive('MidRange_Firearm_Passive', context.Observer) or HasPassive('HighRange_Firearm_Passive', context.Observer)))):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and (not HasPassive('DualWielder', context.Observer) or HasPassive('DualWielder', context.Observer) and HasPassive('Concealed_Carry_Description', context.Observer) and not HasPassive('Offhand_Dual_Wield_Ranged', context.Observer))):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and (HasPassive('DualWielder', context.Observer) or HasPassive('Natural_Opportunity', context.Observer)) and HasPassive('Offhand_Dual_Wield_Ranged', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_OffhandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('LowRange_Firearm_Passive', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack_Blunderbuss,true,true,true);IF(not DistanceToEntityGreaterThan(18, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and (HasPassive('MidRange_Firearm_Passive', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack_Flintlock,true,true,true);IF(not DistanceToEntityGreaterThan(36, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('HighRange_Firearm_Passive', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack_Musket,true,true,true)"
data "Cost" "ReactionActionPoint:1;CounterAction:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Blinded')"
data "EnableContext" "OnStatusRemoved;OnStatusApplied"
data "Stack" "OnEnemyCast"

<!--RESTRICTED TERRITORY-->

new entry "Interrupt_RestrictedTerritory"
type "InterruptData"
data "DisplayName" "8a87461fd8dd4f5b9098ded714f6c8aa00z33;1"
data "Description" "8a87461fd8dd4f5b9098ded714f6c8aa00zg0;3"
data "DescriptionParams" "Distance(3)"
data "Icon" "PassiveFeature_PolearmMaster_AttackOfOpportunity"
data "InterruptContext" "OnEnterAttackRange"
data "InterruptContextScope" "Self"
data "InterruptFlags" "InterruptWhileInvisible"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Observer, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer) and Enemy() and not HasStatus('SG_Invisible',context.Target) and not HasStatus('SG_Incapacitated', context.Source) and not HasStatus('SG_Unconscious', context.Source) and not (not Player(context.Source) and Tagged('AI_IGNORED_TARGET')  and not HasStatus('GNOLL_SUDDENRUSH')) and not HasStatus('SHOCKWAVE') and not (HasStatus('MOBILE_NO_AOO', context.Source) and HasStatus('MOBILE_NO_AOO_SOURCE', context.Target)) and not HasStatus('FLAMING_SPHERE_AURA') and not HasStatus('SNEAKING',context.Target) and not HasStatus('SG_Ignore_AOO',context.Target) and not AnyEntityIsItem()"
data "Properties" "IF(not Unarmed(context.Observer) and (not HasPassive('DualWielder', context.Observer) or HasPassive('DualWielder', context.Observer) and not HasPassive('Offhand_Dual_Wield', context.Observer))):UseSpell(Target_MainHandAttack,true,true,true);IF(not Unarmed(context.Observer) and (HasPassive('DualWielder', context.Observer) or HasPassive('Natural_Opportunity', context.Observer)) and HasPassive('Offhand_Dual_Wield', context.Observer)):UseSpell(Target_OffhandAttack,true,true,true);IF(Unarmed(context.Observer) or HasStatus('SG_Polymorph_BeastShape', context.Observer)):UseAttack()"
data "Cost" "ReactionActionPoint:1;CounterAction:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Blinded')"
data "EnableContext" "OnStatusRemoved;OnStatusApplied"
data "Stack" "OnEnterRange"

<!--SENTINEL-->

new entry "Interrupt_Sentinel"
type "InterruptData"
data "DisplayName" "8a87461fd8dd4f5b9098ded714f6c8aa00z35;1"
data "Description" "8a87461fd8dd4f5b9098ded714f6c8aa00zi0;1"
data "Icon" "PassiveFeature_Sentinel_Attack"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Nearby"
data "InterruptFlags" "InterruptWhileInvisible"
data "Container" "YesNoDecision"
data "Conditions" "not Self(context.Target,context.Observer) and Enemy(context.Source,context.Observer) and Ally(context.Target, context.Observer) and CanSee(context.Source,context.Observer) and IsAbleToReact(context.Observer) and not HasStatus('SG_Invisible',context.Source) and not HasStatus('FIREARM_MALFUNCTION',context.Observer) and not AnyEntityIsItem() and HasLastAttackTriggered() and ((not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer)) or (not DistanceToEntityGreaterThan(18, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and not (HasPassive('Concealed_Carry_Description', context.Observer) or HasPassive('Offhand_Dual_Wield_Ranged', context.Observer) or HasPassive('HighRange_Firearm_Passive', context.Observer) or HasPassive('MidRange_Firearm_Passive', context.Observer) or HasPassive('LowRange_Firearm_Passive', context.Observer))) or (not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('Concealed_Carry_Description', context.Observer) and not HasPassive('Offhand_Dual_Wield_Ranged', context.Observer)) or (not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('Concealed_Carry_Description', context.Observer) and HasPassive('Offhand_Dual_Wield_Ranged', context.Observer)) or (not DistanceToEntityGreaterThan(36, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('HighRange_Firearm_Passive', context.Observer) and HasStatus('MUSKET_PRECISE', context.Observer)) or (not DistanceToEntityGreaterThan(18, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('HighRange_Firearm_Passive', context.Observer) and not HasStatus('MUSKET_PRECISE', context.Observer)) or (not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('MidRange_Firearm_Passive', context.Observer)) or (not DistanceToEntityGreaterThan(4.5, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('LowRange_Firearm_Passive', context.Observer)))"
data "Properties" "IF(not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer) and not Unarmed(context.Observer) and (not HasPassive('DualWielder', context.Observer) or HasPassive('DualWielder', context.Observer) and not HasPassive('Offhand_Dual_Wield', context.Observer))):UseSpell(OBSERVER_SOURCE,Target_MainHandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer) and not Unarmed(context.Observer) and (HasPassive('DualWielder', context.Observer) or HasPassive('Natural_Opportunity', context.Observer)) and HasPassive('Offhand_Dual_Wield', context.Observer)):UseSpell(OBSERVER_SOURCE,Target_OffhandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not WieldingWeapon('Ammunition', false, false, context.Observer) and (Unarmed(context.Observer) or HasStatus('SG_Polymorph_BeastShape', context.Observer))):UseAttack(OBSERVER_SOURCE);IF(not DistanceToEntityGreaterThan(18, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and (not HasPassive('DualWielder', context.Observer) or HasPassive('DualWielder', context.Observer) and not HasPassive('Concealed_Carry_Description', context.Observer)) and not HasPassive('HighRange_Firearm_Passive', context.Observer) and not HasPassive('MidRange_Firearm_Passive', context.Observer) and not HasPassive('LowRange_Firearm_Passive', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and (not HasPassive('DualWielder', context.Observer) or HasPassive('DualWielder', context.Observer) and HasPassive('Concealed_Carry_Description', context.Observer) and not HasPassive('Offhand_Dual_Wield_Ranged', context.Observer))):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and (HasPassive('DualWielder', context.Observer) or HasPassive('Natural_Opportunity', context.Observer)) and HasPassive('Offhand_Dual_Wield_Ranged', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_OffhandAttack,true,true,true);IF(not DistanceToEntityGreaterThan(36, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('HighRange_Firearm_Passive', context.Observer) and HasStatus('MUSKET_PRECISE', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack_Musket,true,true,true);IF(not DistanceToEntityGreaterThan(18, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('HighRange_Firearm_Passive', context.Observer) and not HasStatus('MUSKET_PRECISE', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack_Musket,true,true,true);IF(not DistanceToEntityGreaterThan(9, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('MidRange_Firearm_Passive', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack_Flintlock,true,true,true);IF(not DistanceToEntityGreaterThan(4.5, context.ObserverPosition, context.Source) and WieldingWeapon('Ammunition', false, false, context.Observer) and HasPassive('LowRange_Firearm_Passive', context.Observer)):UseSpell(OBSERVER_SOURCE,Projectile_MainHandAttack_Blunderbuss,true,true,true)"
data "Cost" "ReactionActionPoint:1;CounterAction:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Blinded')"
data "EnableContext" "OnStatusRemoved;OnStatusApplied"
data "Stack" "OnAllyAttacked"

<!--SHIELDBEARER-->

new entry "Interrupt_Shieldbearer_DefensiveFortress"
type "InterruptData"
data "DisplayName" "8a87461fd8dd4f5b9098ded714f6c8aazzz37;1"
data "Description" "8a87461fd8dd4f5b9098ded714f6c8aazzzk0;1"
data "Icon" "PassiveFeature_MultiattackDefense"
data "InterruptContext" "OnPreDamage"
data "InterruptContextScope" "Self"
data "InterruptFlags" "InterruptWhileInvisible"
data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Target,context.Observer) and IsAttack() and HasDamageEffectFlag(DamageFlags.Hit) and not HasStatus('SG_Blinded',context.Observer) and not HasStatus('SG_Prone',context.Observer) and not HasStatus('SG_Incapacitated',context.Observer)"
data "Properties" "SetRoll(0)"
data "Cost" "ReactionActionPoint:1;Shieldbearer:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "HasShieldEquipped(context.Observer)"
data "EnableContext" "OnEquip"
data "Stack" "SelfAboutBeHit"

<!--WARCASTER-->

new entry "Interrupt_WarCaster"
type "InterruptData"
data "DisplayName" "8a87461fd8dd4f5b9098ded714f6c8aa00z41;2"
data "Description" "8a87461fd8dd4f5b9098ded714f6c8aa00zo0;3"
data "Icon" "PassiveFeature_WarCaster_OpportunitySpell"
data "InterruptContext" "OnEnterAttackRange"
data "InterruptContextScope" "Self"
data "InterruptFlags" "InterruptWhileInvisible"
data "Container" "YesNoDecision"
data "Conditions" "not HasSpellCastBlocked(context.Observer) and IsAbleToReact(context.Observer) and Self(context.Observer, context.Source) and Enemy() and not HasStatus('SG_Invisible',context.Target) and not HasStatus('SG_Incapacitated', context.Source) and not HasStatus('SG_Unconscious', context.Source) and not (not Player(context.Source) and Tagged('AI_IGNORED_TARGET')  and not HasStatus('GNOLL_SUDDENRUSH')) and not HasStatus('SHOCKWAVE') and not (HasStatus('MOBILE_NO_AOO', context.Source) and HasStatus('MOBILE_NO_AOO_SOURCE', context.Target)) and not HasStatus('FLAMING_SPHERE_AURA') and not HasStatus('SNEAKING',context.Target) and not HasStatus('SG_Ignore_AOO',context.Target) and not AnyEntityIsItem()"
data "Properties" "UseSpell(Target_ShockingGrasp,true,true,true)"
data "Stack" "OnEnterRange"
data "InterruptDefaultValue" "Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph_BeastShape') and not HasStatus('SG_Blinded')"
data "EnableContext" "OnStatusRemoved;OnStatusApplied"
data "Cost" "CounterAction:1"
